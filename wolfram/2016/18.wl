p = If[#=="^", 1, 0] & /@ Characters[".^^^^^.^^.^^^.^...^..^^.^.^..^^^^^^^^^^..^...^^.^..^^^^..^^^^...^.^.^^^^^^^^....^..^^^^^^.^^^.^^^.^^"]
f[x_] := 1 - NestList[ CellularAutomaton[90, {#, 0}, { {{1}}, {0, Length[#] - 1} } ] &, p, x - 1 ] // Total[#, 2]&
Print[f[40]]
Print[f[400000]]
